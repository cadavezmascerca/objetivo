<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Siempre deberías ser objetivo.</title>

  <!-- Fuentes -->
  <link href="https://fonts.googleapis.com/css2?family=Cinzel+Decorative:wght@700&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;500&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600&display=swap" rel="stylesheet">

  <style>
    html,body{
      height:100%;
      margin:0;
      font-family:'Montserrat',sans-serif;
      overflow:hidden;
    }

    /* FONDO COMPLETO: azul oscuro + líneas diagonales rojas + niebla energética */
    body{
      height:100%;
      margin:0;
      display:flex;
      justify-content:center;
      align-items:center;
      overflow:hidden;
      background:#000814;
      position:relative;
    }

    /* Líneas diagonales rojas difuminadas */
    body::before{
      content:"";
      position:absolute;
      top:0;
      left:0;
      width:200%;
      height:200%;
      background:
        linear-gradient(180deg, #000814 0%, #00172e 100%),
        repeating-linear-gradient(
          135deg,
          rgba(255,0,0,0.12) 0px,
          rgba(255,0,0,0.12) 12px,
          rgba(150,0,0,0.14) 12px,
          rgba(150,0,0,0.14) 24px
        );
      background-blend-mode:overlay;
      filter:blur(0.6px);
      animation:mistMove 45s linear infinite;
      z-index:-2;
    }

    /* Niebla energética suave */
    body::after{
      content:"";
      position:absolute;
      top:-50%;
      left:-50%;
      width:200%;
      height:200%;
      background:radial-gradient(circle at 30% 30%, rgba(0,120,255,0.10), transparent 60%),
                 radial-gradient(circle at 70% 70%, rgba(255,0,80,0.10), transparent 60%);
      filter:blur(90px);
      animation:energyFlow 60s ease-in-out infinite alternate;
      z-index:-1;
    }

    /* Movimiento lento de la niebla */
    @keyframes mistMove{
      0% { transform:translate(0,0); }
      50% { transform:translate(-5%, -5%); }
      100% { transform:translate(0,0); }
    }

    /* Movimiento orgánico de energía */
    @keyframes energyFlow{
      0% { transform:scale(1) translate(0,0); opacity:0.5; }
      50% { transform:scale(1.2) translate(4%, -6%); opacity:0.7; }
      100% { transform:scale(1) translate(0,0); opacity:0.5; }
    }

    @keyframes pulseGlow {
      0% { box-shadow:0 0 12px rgba(255,0,0,0.5); }
      50% { box-shadow:0 0 25px rgba(255,0,0,0.9); }
      100% { box-shadow:0 0 12px rgba(255,0,0,0.5); }
    }

    .contenedor{
      width:430px;
      background:rgba(0,0,0,0.45);
      padding:40px;
      border-radius:15px;
      animation:pulseGlow 2.8s infinite ease-in-out;
      backdrop-filter:blur(6px);
      text-align:center;
      z-index:10;
    }

    h1{
      font-family:'Cinzel Decorative',cursive;
      color:#ff1e1e;
      font-size:28px;
      text-shadow:0 0 8px rgba(255,40,40,0.9);
      margin-bottom:28px;
    }

    /* BRILLO ESPECIAL PARA LA PALABRA OBJETIVO */
    .glow-word{
      color:#66cfff;
      text-shadow:
        0 0 4px #2fb8ff,
        0 0 8px #2fb8ff,
        0 0 16px #32c7ff,
        0 0 32px #2cd4ff;
    }

    input{
      width:100%;
      padding:10px;
      border:none;
      outline:none;
      border-radius:7px;
      margin-top:5px;
      font-size:14px;
      text-align:center;
      background-color:#ffffffde;
      font-family:'Playfair Display', serif;
      letter-spacing:0.5px;
    }

    button{
      margin-top:18px;
      width:100%;
      padding:13px;
      background:#ff1e1e;
      border:none;
      border-radius:10px;
      color:white;
      font-size:18px;
      cursor:pointer;
      transition:0.25s;
      font-family:'Playfair Display', serif;
      letter-spacing:1px;
      box-shadow:0 0 10px rgba(255,0,0,0.5);
    }

    button:hover{
      background:#cc0000;
      transform:scale(1.03);
      box-shadow:0 0 15px rgba(255,0,0,0.8);
    }

    .pista{
      display:none;
      margin-top:25px;
      padding:15px;
      color:#00ffea;
      font-size:15px;
      background:#022;
      border-radius:7px;
      border:1px solid #088;
      word-wrap:break-word;
      text-align:left;
      min-height:40px;
    }

    .errorMsg{
      color:#47c6ff;
      margin-top:15px;
      display:none;
      font-size:14px;
      font-family:'Playfair Display', serif;
      text-shadow:0 0 6px rgba(90,180,255,0.9);
    }

    .typewriter span {
      display:inline-block;
      white-space:pre-wrap;
      border-right:2px solid #00ffee;
      animation:cursorBlink 0.7s infinite;
    }

    @keyframes cursorBlink {
      0% { border-color:#00ffee; }
      50% { border-color:transparent; }
      100% { border-color:#00ffee; }
    }
  </style>
</head>

<body>

  <audio id="bgMusic" src="https://files.catbox.moe/7mggy0.mp3" loop></audio>

  <div class="contenedor">
    <h1>Siempre deberías ser <span class="glow-word">objetivo</span>.</h1>

    <input type="text" id="password" placeholder="Ingresa la contraseña">

    <button type="button" onclick="startMusic(); checkPassword();">COMPROBAR</button>

    <div id="error" class="errorMsg"></div>

    <div id="pista" class="pista"></div>
  </div>

  <script>
    function startMusic(){
      const audio = document.getElementById('bgMusic');
      audio.volume = 0.28;
      audio.play().catch(()=>{});
    }

    document.addEventListener('keydown', function(event){
      if(event.key === "Enter"){
        startMusic();
        checkPassword();
      }
    });

    function typeWriterEffect(text, element){
      element.innerHTML = "";
      const span = document.createElement("span");
      element.appendChild(span);
      let i = 0;
      function type(){
        if(i < text.length){
          span.textContent += text[i];
          i++;
          setTimeout(type, 28);
        }
      }
      type();
    }

    async function checkPassword(){
      const password = document.getElementById('password').value.trim();
      const pistaDiv = document.getElementById('pista');
      const errorMsg = document.getElementById('error');

      errorMsg.style.display = "none";
      pistaDiv.style.display = "none";

      if(password === ""){
        errorMsg.textContent = "Escribe una contraseña.";
        errorMsg.style.display = "block";
        return;
      }

      try{
        const response = await fetch('/api/login',{
          method:'POST',
          headers:{'Content-Type':'application/json'},
          body:JSON.stringify({pass:password})
        });

        const data = await response.json();

        if(data.ok){
          pistaDiv.style.display = 'block';
          typeWriterEffect(data.clue, pistaDiv);
        }else{
          errorMsg.textContent = "Sigue intentando...";
          errorMsg.style.display = "block";
        }

      }catch(err){
        errorMsg.textContent = "Error de conexión.";
        errorMsg.style.display = "block";
      }
    }
  </script>

</body>
</html>
